---
title: Customization Guide
description: Learn how to customize Spree from Admin Dashboard to API, Storefront and more.
icon: "award"
---

<Info>
  This guide requires Spree 5.2 or later.
</Info>

This guide walks you through creating a complete new Spree resource from scratch, covering Admin Dashboard, Storefront and API. 
By the end, you'll understand how to add new manageable resources to the Spree platform.

## Overview

Building an admin resource in Spree typically involves:

1. Creating a model
3. Running scaffold generator
4. Customzing views (index, new, edit, form)
7. Adding navigation menu items
8. Writing tests

## Example: Building a Brand Resource

Let's create a complete "Brand" resource that allows admins to manage product brands.

## Step 1: Create the Migration

Create a new model migration file:

```bash
bin/rails g migration CreateSpreeBrands name:string:index slug:string:uniq active:boolean:index position:integer:index
```

Add a reference to the newly created brand model in the `spree_products` table:

```bash
bin/rails g migration AddBrandIdToSpreeProducts brand:references{foreign_key:false,null:true}
```

Run the migrations:

```bash
bin/rails db:migrate
```

### Step 2: Create the Model

Create the model file at `app/models/spree/brand.rb`:

```ruby
module Spree
  class Brand < Spree.base_class
    # FriendlyId for nice URLs, eg. https://example.com/brands/nike-sportswear
    extend FriendlyId
    friendly_id :slug_candidates, use: %i[slugged history]

    # Include metadata support
    include Spree::Metafields

    # Active Storage attachments
    has_one_attached :logo

    # Action text for rich text content
    has_rich_text :description

    # Validations
    validates :name, presence: true
    validates :slug, presence: true, uniqueness: { scope: spree_base_uniqueness_scope }

    # Associations
    has_many :products, class_name: 'Spree::Product', dependent: :nullify

    # Scopes
    scope :active, -> { where(active: true) }
    scope :alphabetical, -> { order(:name) }
    scope :with_logo, -> { includes(:logo_attachment).where.not(logo_attachment: { blob: nil }) }

  end
end
```

**Key points:**
- Inherit from `Spree.base_class` (not `ApplicationRecord`)
- Use `scope: spree_base_uniqueness_scope` for uniqueness validations
- Always specify `class_name` and `dependent` in associations
- Use string columns instead of enums

### Step 3: Run the spree admin scaffold generator

```bash
bin/rails g spree:admin:scaffold Spree::Brand
```

This will create the following files:

- `app/controllers/spree/admin/brands_controller.rb`
- `app/views/spree/admin/brands/index.html.erb`
- `app/views/spree/admin/brands/new.html.erb`
- `app/views/spree/admin/brands/edit.html.erb`
- `app/views/spree/admin/brands/_table_header.html.erb`
- `app/views/spree/admin/brands/_table_row.html.erb`
- `app/views/spree/admin/brands/_filters.html.erb`
- `app/views/spree/admin/brands/_form.html.erb`

It will also automatically add the following routes:

```ruby
namespace :admin do
  resources :brands
end
```

So you can access the brands resource at `http://localhost:3000/admin/brands`.

### Step 4: Customize the Admin Controller

You'll probably want to customize the newly created controller at `app/controllers/spree/admin/brands_controller.rb`:

```ruby
module Spree
  module Admin
    class BrandsController < ResourceController
      # Optional: customize the index collection scope
      # def scope
      #   super.with_logo
      # end

      # Default sort for the index action
      def collection_default_sort
        'name asc'
      end

      # avoid N+1 queries by specifying the includes
      def collection_includes
        { logo_attachment: :blob }
      end

      private

      # Define permitted parameters
      def permitted_resource_params
        params.require(:brand).permit(
          :name,
          :slug,
          :description,
          :logo,
          :active,
          :position
        )
      end
    end
  end
end
```

**Controller inheritance benefits:**
`Spree::Admin::ResourceController` provides:
- Standard CRUD actions (index, new, create, edit, update, destroy)
- Automatic authorization via CanCanCan
- Flash messages
- Collection and object loading
- Pagination support

**Customization points:**
- Override `scope` to modify the index query
- Override `collection_includes` to specify the includes for the index query
- Override `permitted_resource_params` for strong parameters
- Override individual actions (create, update, etc.) for custom logic

### Step 4: Customize the Views

#### Index View

Customize `app/views/spree/admin/brands/index.html.erb` to add sorting support.

```erb
<%= content_for :page_title do %>
  <%= Spree.t(:brands) %>
<% end %>

<%= content_for :page_actions do %>
  <%= link_to_with_icon 'plus', Spree.t(:new_brand), new_object_url, class: 'btn btn-primary' if can?(:create, Spree::Brand) %>
<% end %>

<%= render 'spree/admin/shared/index_table' %> // [!code --]
<%= render 'spree/admin/shared/index_table', sortable: true %> // [!code ++]
```

This uses the standard [index_table.html.erb](https://github.com/spree/spree/blob/main/admin/app/views/spree/admin/shared/_index_table.html.erb) template which handles:
- Turbo Frame wrapping for fast updates
- Automatic empty state handling
- Pagination
- Optional filters support
- Sortable support

#### Table Header Partial

Create `app/views/spree/admin/brands/_table_header.html.erb`:

```erb
<tr>
  <th scope="col"><%= sort_link @search, :name, Spree.t(:name) %></th>
  <th scope="col"><%= Spree.t(:active) %>?</th>
  <th scope="col"></th>
</tr>
```

The `sort_link` helper provides sortable column headers that work with Ransack.

#### Table Row Partial

Customize `app/views/spree/admin/brands/_table_row.html.erb` file to add the following content:

```erb
<tr id="<%= spree_dom_id(brand) %>" data-controller="row-link" class="cursor-pointer">
  <td data-action="click->row-link#openLink"><%= brand.name %></td>
  <td data-action="click->row-link#openLink">
    <%= active_badge(brand.active?) %>
  </td>
  <td class="actions">
    <%= link_to_edit brand, data: { row_link_target: 'link', turbo_frame: '_top' } if can?(:edit, brand) %>
  </td>
</tr>
```

**Key features:**
- `data-controller="row-link"` - Makes entire row clickable
- `spree_dom_id(brand)` - Generates unique ID for Turbo updates
- `active_badge` helper - Displays consistent status badges
- `link_to_edit` helper - Standard edit link with proper permissions
- Dropdown menu for additional actions
- `turbo_frame: '_top'` - Ensures edit navigates full page

#### New View

Scaffold created a `app/views/spree/admin/brands/new.html.erb` template with the following content:

```erb
<%= render 'spree/admin/shared/new_resource' %>
```

That's it! The [new_resource.html.erb](https://github.com/spree/spree/blob/main/admin/app/views/spree/admin/shared/_new_resource.html.erb) partial handles:
- Page title with back button
- Form wrapper with proper URL
- Error message display
- Form partial rendering
- Submit/cancel buttons

#### Edit View

Scaffold created a `app/views/spree/admin/brands/edit.html.erb` template with the following content:

```erb
<%= render 'spree/admin/shared/edit_resource' %>
```

The [edit_resource.html.erb](https://github.com/spree/spree/blob/main/admin/app/views/spree/admin/shared/_edit_resource.html.erb) partial handles:
- Page title with resource name
- Form wrapper with proper URL
- Error message display
- Form partial rendering
- Submit/cancel buttons
- Delete button

#### Form Partial

Customize `app/views/spree/admin/brands/_form.html.erb` file to add the following fields:

```erb
<div class="card mb-4" data-controller="slug-form">
  <div class="card-header">
    <h5 class="card-title">
      <%= Spree.t(:general_settings) %>
    </h5>
  </div>

  <div class="card-body">
    <%= f.spree_text_field :name,
        required: true,
        help: "Brand name as displayed to customers",
        data: { slug_form_target: :name, action: 'slug-form#updateUrlFromName' } %>

    <%= f.spree_text_field :slug,
        required: true,
        help: "URL-friendly identifier (auto-generated from name)",
        data: { slug_form_target: :url } %>

    <%= f.spree_rich_text_area :description,
        help: "Optional brand description" %>

    <%= f.spree_check_box :active,
        label: "Active" %>
  </div>
</div>

<div class="card mb-4">
  <div class="card-header">
    <h5 class="card-title"><%= Spree.t(:images) %></h5>
  </div>
  <div class="card-body">
    <%= f.label :logo, Spree.t(:logo) %>
    <%= render 'active_storage/upload_form',
        form: f,
        field_name: :logo,
        width: 800,
        height: 400 %>
    <%= f.error_message_on :logo %>
  </div>
</div>
```

**Form structure:**
- Stack cards vertically
- Use card components for visual grouping
- Use [Spree::Admin::FormBuilder](/developer/admin/form-builder) methods (automatically available)
- Add help text for non-obvious fields
- Use `active_storage/upload_form` partial for file uploads with specified dimensions
- Use `slug-form` Stimulus controller for slug generation preview (so user don't need to type the slug manually)
- Uses `spree_rich_text_area` to embed a fully-featured rich text editor

### Step 5: Add Navigation Menu Item

#### Create Navigation Partial

Create `app/views/spree/admin/shared/_brands_nav.html.erb`:

```erb
<% if can?(:manage, Spree::Brand) %>
  <%= nav_item(
    Spree.t(:brands),
    spree.admin_brands_path,
    icon: 'tag',
    active: controller_name == 'brands'
  ) %>
<% end %>
```

**Key elements:**
- Wrap with `can?()` authorization check
- Use `nav_item` helper for proper formatting
- Specify icon from [Tabler Icons](https://tabler.io/icons)
- Define active state based on controller name
- Use `spree.` prefix for route helpers

#### Register Navigation Partial

Add to `config/initializers/spree.rb`:

```ruby
Rails.application.config.spree_admin.store_nav_partials << 'spree/admin/shared/brands_nav'
```

This adds the navigation item to the main sidebar after Reports and before Storefront.

#### Alternative: Add as Submenu Item

To add Brands under the existing Products menu, use the products injection point:

**Create:** `app/views/spree/admin/shared/_brands_products_nav.html.erb`

```erb
<% if can?(:manage, Spree::Brand) %>
  <%= nav_item(
    Spree.t(:brands),
    spree.admin_brands_path,
    active: controller_name == 'brands'
  ) %>
<% end %>
```

**Register:**

```ruby
Rails.application.config.spree_admin.store_products_nav_partials << 'spree/admin/shared/brands_products_nav'
```

### Step 8: Add Translations

Add translations in `admin/config/locales/en.yml`:

```yaml
en:
  spree:
    brands: "Brands"
    brand: "Brand"
    new_brand: "New Brand"
    edit_brand: "Edit Brand"
    logo: "Logo"

  activerecord:
    attributes:
      spree/brand:
        name: "Brand Name"
        slug: "URL Slug"
        description: "Description"
        logo: "Logo"
        active: "Active"
        position: "Position"
```

### Step 9: Write Tests

Create a model spec at `core/spec/models/spree/brand_spec.rb`:

```ruby
require 'spec_helper'

RSpec.describe Spree::Brand, type: :model do
  describe 'validations' do
    it { is_expected.to validate_presence_of(:name) }
    it { is_expected.to validate_presence_of(:slug) }
  end

  describe 'associations' do
    it { is_expected.to have_many(:products).class_name('Spree::Product') }
  end

  describe '#generate_slug' do
    let(:brand) { build(:brand, name: 'Nike Sportswear', slug: nil) }

    it 'generates slug from name' do
      brand.valid?
      expect(brand.slug).to eq('nike-sportswear')
    end
  end
end
```

Create a controller spec at `admin/spec/controllers/spree/admin/brands_controller_spec.rb`:

```ruby
require 'spec_helper'

RSpec.describe Spree::Admin::BrandsController, type: :controller do
  render_views
  stub_authorization!

  let(:brand) { create(:brand) }

  describe 'GET #index' do
    it 'loads all brands' do
      get :index
      expect(assigns(:brands)).to include(brand)
    end
  end

  describe 'GET #new' do
    it 'initializes a new brand' do
      get :new
      expect(assigns(:brand)).to be_a_new(Spree::Brand)
    end
  end

  describe 'POST #create' do
    let(:valid_params) { { brand: { name: 'Adidas', slug: 'adidas' } } }

    it 'creates a brand' do
      expect {
        post :create, params: valid_params
      }.to change(Spree::Brand, :count).by(1)
    end
  end

  describe 'PUT #update' do
    let(:new_name) { 'New Brand Name' }

    it 'updates the brand' do
      put :update, params: { id: brand.id, brand: { name: new_name } }
      expect(brand.reload.name).to eq(new_name)
    end
  end

  describe 'DELETE #destroy' do
    it 'deletes the brand' do
      brand # create the brand
      expect {
        delete :destroy, params: { id: brand.id }
      }.to change(Spree::Brand, :count).by(-1)
    end
  end
end
```

Create a factory at `core/lib/spree/testing_support/factories/brand_factory.rb`:

```ruby
FactoryBot.define do
  factory :brand, class: 'Spree::Brand' do
    sequence(:name) { |n| "Brand #{n}" }
    slug { name.parameterize }
    active { true }
    position { 0 }
  end
end
```

## Advanced Features

### Adding Search/Filtering

Use Ransack for filtering in your index view:

```erb
<%= search_form_for @search, url: admin_brands_path do |f| %>
  <div class="card mb-4">
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <%= f.label :name_cont, 'Name' %>
          <%= f.text_field :name_cont, class: 'form-control' %>
        </div>
        <div class="col-md-6">
          <%= f.label :active_eq, 'Status' %>
          <%= f.select :active_eq,
              [['Active', true], ['Inactive', false]],
              { include_blank: 'All' },
              class: 'form-control' %>
        </div>
      </div>
      <%= f.submit 'Filter', class: 'btn btn-primary mt-3' %>
    </div>
  </div>
<% end %>
```

### Adding Bulk Actions

Add bulk actions to your index view:

```erb
<%= form_tag bulk_activate_admin_brands_path, method: :post do %>
  <table class="table" data-controller="bulk-operation">
    <thead>
      <tr>
        <th>
          <%= check_box_tag 'select_all', nil, false,
              data: { action: 'bulk-operation#selectAll' } %>
        </th>
        <!-- other headers -->
      </tr>
    </thead>
    <tbody>
      <% @brands.each do |brand| %>
        <tr>
          <td>
            <%= check_box_tag 'brand_ids[]', brand.id, false,
                data: { target: 'bulk-operation.checkbox' } %>
          </td>
          <!-- other cells -->
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= button_tag 'Activate Selected', class: 'btn btn-primary' %>
<% end %>
```

Add bulk action to controller:

```ruby
def bulk_activate
  Spree::Brand.where(id: params[:brand_ids]).update_all(active: true)
  flash[:success] = "Brands activated successfully"
  redirect_to admin_brands_path
end
```

### Adding Tabs

Add tabs to organize complex forms:

```ruby
# In config/initializers/spree.rb
Rails.application.config.after_initialize do
  Rails.application.config.spree_backend.tabs[:brand] ||= []

  Rails.application.config.spree_backend.tabs[:brand] << Spree::Admin::Tabs::Tab.new(
    name: 'products',
    label: :products,
    partial: 'spree/admin/brands/products_tab',
    url: :admin_brand_path
  )
end
```

## Troubleshooting

### Routes Not Found

Make sure you're using the correct route helpers:

```erb
<%= link_to 'Brands', spree.admin_brands_path %>
```

Note the `spree.` prefix for engine routes.

### Permissions Denied

Ensure your ability is registered and permissions are defined:

```ruby
# Check current user abilities in console
ability = Spree::Ability.new(current_user)
ability.can?(:manage, Spree::Brand) # should return true
```

### Views Not Rendering

Make sure your views are in the correct location:
- `app/views/spree/admin/brands/`

Not `app/views/admin/brands/` (incorrect).

### Translations Missing

Verify translation files are in the correct location:
- Admin: `admin/config/locales/en.yml`
- Core: `core/config/locales/en.yml`

## Best Practices

<Check>
  **Follow Spree conventions** for naming and file structure
</Check>

<Check>
  **Inherit from ResourceController** for standard CRUD operations
</Check>

<Check>
  **Use scaffolding partials** (`new_resource`, `edit_resource`) for consistency
</Check>

<Check>
  **Always define permissions** using CanCanCan abilities
</Check>

<Check>
  **Add comprehensive tests** for models, controllers, and features
</Check>

<Check>
  **Use Spree::Admin::FormBuilder** methods for all form fields
</Check>

<Check>
  **Add translations** for all user-facing text
</Check>

## See Also

- [FormBuilder API](/developer/admin/form-builder) - Complete FormBuilder reference
- [Common Patterns](/developer/admin/common-patterns) - Reusable patterns and examples
- [Extending UI](/developer/admin/extending-ui) - Injection points and customization
- [Navigation](/developer/admin/navigation) - Menu and navigation customization
- [Permissions](/developer/admin/permissions) - Authorization and abilities
