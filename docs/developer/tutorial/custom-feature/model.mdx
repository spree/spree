---
title: Create a Brands Model
sidebarTitle: Brands Model
description: Learn how to create a database model for the Brands feature
---

## Step 1: Create Database Migration

First we need to create a database migration to add the new brand model to the database. Database migrations are used to create or modify the database schema. They are typically created using the `rails g migration` command. Each migration file is named after the change it makes, date and time of creation, and contains the SQL commands to perform the change.

Create a new model migration file by running the following command in your Spree application root directory:

```bash
bin/rails g migration CreateSpreeBrands name:string:index slug:string:uniq status:string:index position:integer:index published_at:datetime
```

This should create a new migration file at `db/migrate/<YYYYMMDDHHMMSS>_create_spree_brands.rb` with the following content:

```ruby
class CreateSpreeBrands < ActiveRecord::Migration[8.0]
  def change
    create_table :spree_brands do |t|
      t.string :name
      t.string :slug
      t.string :status
      t.integer :position
      t.datetime :published_at

    end
    add_index :spree_brands, :name
    add_index :spree_brands, :slug, unique: true
    add_index :spree_brands, :status
    add_index :spree_brands, :position
  end
end
```

<Info>
  As you can see, we're using the `:index` option to add indexes to the columns. This is a good practice to improve performance when querying the database. Also the `:uniq` option is used to add a unique index to the column, as we're going to use the `slug` column for unique URLs, eg. https://example.com/brands/nike-sportswear
</Info>

Now run the migration:

```bash
bin/rails db:migrate
```

This command will create the `spree_brands` table in the database and add the necessary indexes. It will also update your `db/schema.rb` file to reflect the changes.

## Step 2: Create the Model file

Now we need to create the model file at `app/models/spree/brand.rb`:

```bash
mkdir -p app/models/spree && touch app/models/spree/brand.rb
```

Add the following code to the file:

```ruby
module Spree
  class Brand < Spree::Base
    # FriendlyId for nice URLs, eg. https://example.com/brands/nike-sportswear
    extend FriendlyId
    friendly_id :slug_candidates, use: %i[slugged]

    # Ability to reorder the brands
    acts_as_list

    # Include metadata support
    include Spree::Metafields

    # Active Storage attachments
    has_one_attached :logo

    # Action text for rich text content
    has_rich_text :description

    # Validations
    validates :name, presence: true
    validates :slug, presence: true, uniqueness: true

    # Scopes
    scope :published, -> { where(status: 'published') }
    scope :alphabetical, -> { order(:name) }
    scope :with_logo, -> { includes(:logo_attachment).where.not(logo_attachment: { blob: nil }) }

    # Ransack configuration
    self.whitelisted_ransackable_attributes = %w[name slug status published_at]
    self.whitelisted_ransackable_scopes = %w[published with_logo]

    # State machine for brand status
    state_machine :status, initial: :draft do
      event :publish do
        transition :draft to :published
      end
      after_transition to: :published do |brand|
        # Set the published_at timestamp when the brand is published  
        brand.update(published_at: Time.current)
      end
    end
  end
end
```

This is a standard [Ruby on Rails ActiveRecord model](https://guides.rubyonrails.org/active_record_basics.html) with all the bells and whistles for a Brand resource. Let's break down each part:
- Inherits from `Spree::Base` to automatically inherit all Spree functionality. Also the model itself is namespaced under `Spree::` module, so it's available as `Spree::Brand` in the application.
- `extend FriendlyId` - Use [FriendlyId slugs](/developer/core-concepts/slugs) library for nice URLs
- `acts_as_list` - Use [acts_as_list](https://github.com/brendon/acts_as_list) to allow for reordering the brands, so admins can prioritize the brands in the Admin Dashboard
- `include Spree::Metafields` - Include `Spree::Metafields` for [Metafields](/developer/core-concepts/metafields) support to easily add metadata and custom attributes to the brand model from the Admin Dashboard
- `has_one_attached :logo` - Use [Rails Active Storage](https://guides.rubyonrails.org/active_storage_overview.html) for file attachments and image processing. Active Storage can be used for non-image files as well
- `has_rich_text :description` - Use [Rails Action Text](https://guides.rubyonrails.org/action_text_overview.html) for rich text content, enabling admins to use a WYSIWYG editor to add formatted text to the brand model from the Admin Dashboard
- `validates :name, presence: true` - Validate that the name is present
- `validates :slug, presence: true, uniqueness: true` - Validate that the slug is present and unique
- `scope :published, -> { where(status: 'published') }` - Scope to filter the brands by status
- `self.whitelisted_ransackable_attributes` and `self.whitelisted_ransackable_scopes` - Allow for searching, filtering and sorting the brands in the Admin Dashboard using [Ransack search & filtering](/developer/core-concepts/search-filtering)
- `state_machine :status, initial: :draft do` - Use State Machines to manage the brand status, allowing to attach events to the status transitions, eg. `publish` event to transition the brand from `draft` to `published` status
