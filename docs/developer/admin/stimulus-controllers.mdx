---
title: Stimulus Controllers Reference
sidebarTitle: Stimulus Controllers
---

Spree Admin includes a comprehensive set of Stimulus controllers that provide interactive functionality throughout the admin interface. These controllers handle everything from form enhancements to complex UI interactions.

<Note>
  **Best Practice:** Whenever possible, use Spree's helper methods (like `dropdown`, `nav_item`, `active_badge`, etc.) instead of manually writing HTML with Stimulus controllers. Helper methods ensure consistent styling, automatic controller setup, and easier maintenance.
</Note>

## Overview

Stimulus controllers are JavaScript modules that add behavior to HTML elements. They're automatically loaded and activated when their `data-controller` attribute is found in the DOM.

### Basic Usage

```erb
<div data-controller="dropdown">
  <button data-action="click->dropdown#toggle">Menu</button>
  <div data-dropdown-target="menu" class="hidden">
    <!-- Menu content -->
  </div>
</div>
```

**Key concepts:**
- `data-controller` - Declares which controller(s) to use
- `data-action` - Defines event listeners and actions
- `data-{controller}-target` - Marks elements for controller access
- `data-{controller}-{name}-value` - Passes configuration values

## Form Enhancement Controllers

### autocomplete-select

Adds autocomplete/search functionality to select dropdowns using TomSelect.

**Usage:**
```erb
<%= f.spree_select :country_id,
    Country.pluck(:name, :id),
    { autocomplete: true },
    {} %>
```

Or manually:
```erb
<select data-controller="autocomplete-select">
  <option value="1">Option 1</option>
  <option value="2">Option 2</option>
</select>
```

**Features:**
- Searchable dropdown with fuzzy matching
- Keyboard navigation
- Prevents clearing selection on blur
- Supports single and multiple selection
- Remove buttons for multi-select

**Targets:** None
**Values:** None
**Actions:** Automatically initialized on connect

---

### select

Advanced select controller with remote data fetching and dynamic option creation.

**Usage:**
```erb
<select data-controller="select"
        data-select-url-value="/api/products/search"
        data-select-create-value="true">
</select>
```

**Features:**
- Remote data fetching via AJAX
- Create new options on the fly
- Tagging support
- Load more / pagination
- Custom rendering

**Targets:** None
**Values:**
- `url` (String) - API endpoint for remote data
- `create` (Boolean) - Allow creating new options

---

### textarea-autogrow

Automatically expands textareas as content grows.

**Usage:**
```erb
<%= f.spree_text_area :description %>
```

The FormBuilder automatically adds this controller. For manual use:
```erb
<textarea data-controller="textarea-autogrow"></textarea>
```

**Features:**
- Grows vertically as user types
- Shrinks when content is deleted
- Respects min-height

---

### color-picker

Color picker input with visual color selection.

**Usage:**
```erb
<input type="text"
       data-controller="color-picker"
       data-color-picker-palette-value='["#FF0000", "#00FF00", "#0000FF"]'>
```

**Targets:** None
**Values:**
- `palette` (Array) - Predefined color options

---

### calendar-range

Date range picker for filtering and date selection.

**Usage:**
```erb
<div data-controller="calendar-range">
  <input type="text" data-calendar-range-target="start">
  <input type="text" data-calendar-range-target="end">
</div>
```

**Features:**
- Date range selection
- Visual calendar interface
- Preset ranges (Today, Last 7 days, etc.)
- Clears invalid dates

**Targets:**
- `start` - Start date input
- `end` - End date input

---

### multi-input

Allows adding/removing multiple input fields dynamically.

**Usage:**
```erb
<div data-controller="multi-input">
  <div data-multi-input-target="container">
    <input type="text" name="tags[]">
  </div>
  <button data-action="click->multi-input#add">Add More</button>
</div>
```

**Features:**
- Add new input fields
- Remove existing fields
- Maintains proper naming for arrays

**Targets:**
- `container` - Container for input fields
- `template` - Template for new fields

## UI Component Controllers

### dropdown

Dropdown menus with floating positioning and keyboard support.

<Tip>
  **Use Helper Methods:** Instead of writing dropdown HTML manually, use the `dropdown`, `dropdown_toggle`, and `dropdown_menu` helper methods for consistent styling and automatic controller setup.
</Tip>

**Recommended Usage with Helpers:**
```erb
<%= dropdown do %>
  <%= dropdown_toggle class: 'btn-sm' do %>
    <%= icon('dots-vertical') %>
  <% end %>

  <%= dropdown_menu class: 'dropdown-menu-right' do %>
    <%= link_to_with_icon 'edit', Spree.t(:edit), edit_admin_brand_path(@brand), class: 'dropdown-item' %>
    <%= link_to_with_icon 'trash', Spree.t(:delete), admin_brand_path(@brand),
        class: 'dropdown-item text-danger',
        data: { turbo_method: :delete, turbo_confirm: Spree.t(:are_you_sure) } %>
  <% end %>
<% end %>
```

**Manual Usage (if needed):**
```erb
<div data-controller="dropdown">
  <button data-action="click->dropdown#toggle"
          data-dropdown-target="toggle"
          class="btn">
    Open Menu
  </button>
  <div data-dropdown-target="menu" class="dropdown-container hidden">
    <a href="#" class="dropdown-item">Menu Item 1</a>
    <a href="#" class="dropdown-item">Menu Item 2</a>
  </div>
</div>
```

**Features:**
- Smart positioning (uses Floating UI)
- Auto-flip to stay in viewport
- Closes on outside click
- Closes on Escape key
- Keyboard navigation

**Targets:**
- `menu` - The dropdown menu element
- `toggle` - The trigger button (optional)

**Values:**
- `placement` (String) - Initial placement (default: "bottom-start")
- `offset` (Number) - Distance from trigger (default: 4)

**Actions:**
- `toggle` - Toggle open/close
- `open` - Open the dropdown
- `close` - Close the dropdown

**Helper Methods:**
- `dropdown(options = {})` - Creates the dropdown container with `data-controller="dropdown"`
- `dropdown_toggle(options = {})` - Creates the toggle button with proper data attributes
- `dropdown_menu(options = {})` - Creates the menu container with proper classes and positioning

---

### filters

Manages filter badges and filter form state.

**Usage:**
```erb
<div data-controller="filters"
     data-filters-url-value="<%= admin_products_path %>">
  <div data-filters-target="badgesContainer"></div>

  <%= form_with url: admin_products_path, method: :get do |f| %>
    <%= f.text_field :q_name_cont,
        data: { filters_target: 'input' } %>
    <%= f.select :q_active_eq, [['Active', true], ['Inactive', false]],
        {},
        { data: { filters_target: 'input' } } %>
  <% end %>

  <template data-filters-target="badgeTemplate">
    <span class="badge">
      LABEL
      <a href="DELETE_URL">Ã—</a>
    </span>
  </template>
</div>
```

**Features:**
- Displays active filters as badges
- Removable badges with updated URL
- Works with Ransack search
- Supports TomSelect dropdowns

**Targets:**
- `input` - Form inputs to track
- `badgesContainer` - Where to display badges
- `badgeTemplate` - HTML template for badges

**Values:**
- `url` (String) - Base URL for filter links

---

### clipboard

Copy text to clipboard with visual feedback.

<Tip>
  **Use Helper Methods:** Use `clipboard_component` helper for a complete clipboard solution with button and visual feedback.
</Tip>

**Recommended Usage with Helper:**
```erb
<%= clipboard_component("Text to copy") %>
```

This creates a complete clipboard component with:
- Hidden field containing the text to copy
- Copy button with icon
- Tooltip with "Copy to clipboard" text
- Success feedback (checkmark icon)

**Manual Usage (if needed):**
```erb
<button data-controller="clipboard"
        data-clipboard-text-value="Text to copy"
        data-action="click->clipboard#copy">
  Copy
</button>
```

Or copy from another element:
```erb
<div data-controller="clipboard">
  <input type="text" value="API Key" data-clipboard-target="source">
  <button data-action="click->clipboard#copy">Copy</button>
</div>
```

**Targets:**
- `source` (optional) - Element containing text to copy

**Values:**
- `text` (String) - Text to copy (alternative to source target)

**Actions:**
- `copy` - Copy text and show feedback

**Helper Methods:**
- `clipboard_component(text, options = {})` - Complete clipboard component with button and feedback
- `clipboard_button(options = {})` - Just the copy button (use within a clipboard controller)

---

### highlight

Highlights search terms in text content.

**Usage:**
```erb
<div data-controller="highlight"
     data-highlight-term-value="<%= params[:q] %>">
  <p>This text will have matching terms highlighted</p>
</div>
```

**Values:**
- `term` (String) - Search term to highlight

---

### auto-scroll

Automatically scrolls to elements (useful for flash messages or errors).

**Usage:**
```erb
<div data-controller="auto-scroll" data-auto-scroll-offset-value="100">
  <!-- Content -->
</div>
```

**Values:**
- `offset` (Number) - Offset from top of viewport (default: 0)

## Data Management Controllers

### bulk-operation

Handles bulk selection and operations on table rows.

**Usage:**
```erb
<table data-controller="bulk-operation">
  <thead>
    <tr>
      <th>
        <input type="checkbox"
               data-bulk-operation-target="checkboxAll"
               data-action="change->bulk-operation#toggleAll">
      </th>
      <th>Name</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @items.each do |item| %>
      <tr>
        <td>
          <input type="checkbox"
                 data-bulk-operation-target="checkbox"
                 data-action="change->bulk-operation#toggle"
                 value="<%= item.id %>">
        </td>
        <td><%= item.name %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<form data-bulk-operation-target="form">
  <div data-bulk-operation-target="panel" class="d-none">
    <span data-bulk-operation-target="counter">0</span> selected
    <button data-action="click->bulk-operation#setBulkAction"
            data-url="<%= bulk_delete_admin_items_path %>"
            data-method="delete">
      Delete Selected
    </button>
    <button data-action="click->bulk-operation#cancel">Cancel</button>
  </div>
</form>
```

**Features:**
- Select all/deselect all
- Visual feedback on selected rows
- Bulk action panel with counter
- Animated panel appearance
- Multiple bulk actions support

**Targets:**
- `checkbox` - Individual checkboxes
- `checkboxAll` - Select all checkbox
- `panel` - Bulk action panel
- `form` - Form for bulk operations
- `counter` - Selected count display

**Actions:**
- `toggle` - Toggle individual checkbox
- `toggleAll` - Toggle all checkboxes
- `cancel` - Cancel selection
- `setBulkAction` - Set form action URL
- `refresh` - Update panel state

---

### filters

See "UI Component Controllers" section above.

---

### import-form

Handles file imports with progress tracking.

**Usage:**
```erb
<form data-controller="import-form">
  <input type="file" data-import-form-target="file">
  <div data-import-form-target="progress" class="hidden">
    <div class="progress-bar" data-import-form-target="progressBar"></div>
  </div>
</form>
```

**Targets:**
- `file` - File input
- `progress` - Progress container
- `progressBar` - Progress bar element

## Advanced Controllers

### asset-uploader

Drag-and-drop file upload with preview and progress.

**Usage:**
```erb
<div data-controller="asset-uploader"
     data-asset-uploader-url-value="<%= upload_admin_assets_path %>"
     data-asset-uploader-accepted-types-value='["image/jpeg", "image/png"]'>
  <div data-asset-uploader-target="dropzone">
    Drop files here or click to upload
  </div>
  <div data-asset-uploader-target="previews"></div>
</div>
```

**Features:**
- Drag and drop upload
- Multiple file support
- File type validation
- Upload progress
- Image previews
- Error handling

**Targets:**
- `dropzone` - Drop area
- `previews` - Preview container
- `template` - Preview template

**Values:**
- `url` (String) - Upload endpoint
- `acceptedTypes` (Array) - Allowed MIME types
- `maxSize` (Number) - Max file size in bytes

---

### slug-form

Auto-generates URL slugs from title fields.

**Usage:**
```erb
<div data-controller="slug-form">
  <%= f.text_field :name, data: { slug_form_target: 'source' } %>
  <%= f.text_field :slug, data: { slug_form_target: 'slug' } %>
</div>
```

**Features:**
- Auto-generates slug from source field
- Parameterizes text (removes special chars)
- Only auto-fills if slug is empty
- Allows manual override

**Targets:**
- `source` - Source text field (e.g., name)
- `slug` - Slug field

---

### seo-form

SEO metadata management with character counters.

**Usage:**
```erb
<div data-controller="seo-form">
  <%= f.text_field :meta_title,
      data: { seo_form_target: 'title', action: 'input->seo-form#updateTitleCount' } %>
  <span data-seo-form-target="titleCount">0</span> / 60 characters

  <%= f.text_area :meta_description,
      data: { seo_form_target: 'description', action: 'input->seo-form#updateDescriptionCount' } %>
  <span data-seo-form-target="descriptionCount">0</span> / 160 characters
</div>
```

**Features:**
- Character counting
- Optimal length indicators
- Real-time validation

**Targets:**
- `title` - Meta title input
- `description` - Meta description input
- `titleCount` - Title character counter
- `descriptionCount` - Description character counter

---

### search-picker

Advanced search and selection interface (e.g., for product picker).

**Usage:**
```erb
<div data-controller="search-picker"
     data-search-picker-url-value="<%= search_admin_products_path %>">
  <input type="search" data-search-picker-target="search">
  <div data-search-picker-target="results"></div>
  <div data-search-picker-target="selected"></div>
</div>
```

**Features:**
- Live search with debouncing
- Selection management
- Remove selected items
- Template-based rendering

**Targets:**
- `search` - Search input
- `results` - Search results container
- `selected` - Selected items container

**Values:**
- `url` (String) - Search API endpoint
- `delay` (Number) - Debounce delay in ms

---

### replace

Replaces element content via Turbo Stream.

**Usage:**
```erb
<div data-controller="replace"
     data-replace-url-value="<%= admin_product_path(@product) %>"
     data-replace-interval-value="5000">
  <!-- Content will be replaced -->
</div>
```

**Features:**
- Periodic content replacement
- Manual refresh
- Turbo Stream response handling

**Values:**
- `url` (String) - URL to fetch content
- `interval` (Number) - Refresh interval in ms

**Actions:**
- `refresh` - Manually trigger refresh

---

### turbo-submit-button

Disables submit buttons and shows loading state during Turbo form submissions.

**Usage:**
```erb
<%= form_with model: @product do |f| %>
  <%= f.submit 'Save',
      data: {
        controller: 'turbo-submit-button',
        turbo_submit_button_target: 'button'
      } %>
<% end %>
```

**Features:**
- Prevents double submission
- Shows loading state
- Re-enables on Turbo error
- Works with Turbo Drive and Frames

**Targets:**
- `button` - Submit button

## Using Multiple Controllers

You can use multiple controllers on a single element:

```erb
<div data-controller="dropdown filters">
  <!-- Element has both dropdown and filters behavior -->
</div>
```

## Creating Custom Controllers

To add your own Stimulus controller:

1. Create the controller file:
```javascript
// app/javascript/controllers/custom_controller.js
import { Controller } from "@hotwired/stimulus"

export default class extends Controller {
  static targets = ["output"]
  static values = { message: String }

  connect() {
    console.log("Custom controller connected!")
  }

  greet() {
    this.outputTarget.textContent = this.messageValue || "Hello!"
  }
}
```

2. Register it in your application's JavaScript:
```javascript
// app/javascript/application.js
import CustomController from "./controllers/custom_controller"

application.register("custom", CustomController)
```

3. Use it in your views:
```erb
<div data-controller="custom" data-custom-message-value="Hello World">
  <button data-action="click->custom#greet">Greet</button>
  <div data-custom-target="output"></div>
</div>
```

## Best Practices

<Check>
  **Use helper methods first** - Always prefer helper methods like `dropdown`, `clipboard_component`, `icon`, `active_badge`, and `nav_item` over manually writing HTML with controllers
</Check>

<Check>
  **Use built-in controllers** before creating custom ones
</Check>

<Check>
  **Namespace custom controllers** to avoid conflicts (e.g., `data-controller="myapp--custom"`)
</Check>

<Check>
  **Keep controllers focused** - one controller should do one thing well
</Check>

<Check>
  **Use targets** instead of querySelector for better maintainability
</Check>

<Check>
  **Use values** to pass configuration data to controllers
</Check>

<Check>
  **Clean up** in disconnect() method (remove event listeners, timers, etc.)
</Check>

## Debugging Tips

### Check if controller is connected
```javascript
// In browser console
$0.dataset.controller // Should show controller names
```

### Log controller lifecycle
```javascript
connect() {
  console.log("Controller connected", this.element)
  super.connect()
}
```

### Verify targets
```javascript
connect() {
  console.log("Targets:", this.targets)
  console.log("Has menu target?", this.hasMenuTarget)
}
```

### Check values
```javascript
connect() {
  console.log("URL value:", this.urlValue)
  console.log("All values:", this.values)
}
```

## See Also

- [Helper Methods](/developer/admin/helper-methods) - Complete reference of available helper methods
- [Stimulus Handbook](https://stimulus.hotwired.dev/handbook/introduction) - Official Stimulus documentation
- [Turbo Handbook](https://turbo.hotwired.dev/handbook/introduction) - Turbo documentation
- [Custom JavaScript](/developer/admin/custom-javascript) - Adding custom JavaScript to admin
- [Common Patterns](/developer/admin/common-patterns) - Common UI patterns using controllers
