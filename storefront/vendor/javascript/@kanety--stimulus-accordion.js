// @kanety/stimulus-accordion@1.1.0 downloaded from https://ga.jspm.io/npm:@kanety/stimulus-accordion@1.1.0/dist/index.module.js

import{Controller as t}from"@hotwired/stimulus";class e{constructor(t){this.controller=t}get togglers(){return this.controller.togglers}get openedTogglers(){return this.controller.openedTogglers}get key(){return this.controller.storeKeyValue}load(){if(this.key){var t=this.constructor.load(this.key);if(t){var i=new Set(t);this.togglers.forEach((t=>{var o=this.controller.findContent(t);i.has(this.controller.getID(t))?this.controller.show(t,o):this.controller.hide(t,o)}))}}}save(){if(this.key){var t=this.openedTogglers.map((t=>this.controller.getID(t)));this.constructor.save(this.key,t)}}static load(t){var i=sessionStorage.getItem(t);try{return JSON.parse(i)}catch(t){return console.error(t),null}}static save(t,i){try{sessionStorage.setItem(t,JSON.stringify(i))}catch(t){return console.error(t),null}}}class s extends t{get togglers(){return this.context.bindingObserver.bindings.filter((t=>"toggle"==t.action.methodName)).map((t=>t.action.element))}get openedTogglers(){return this.togglers.filter((t=>this.isOpened(t)))}get contents(){return this.scope.findAllElements("[data-accordion-id]")}connect(){this.init(),this.store=new e(this),this.store.load()}init(){this.togglers.forEach((t=>{var i=this.findContent(t);this.isOpened(t)?this.show(t,i,!1):this.hide(t,i,!1)}))}toggle(t){this.togglers.forEach((i=>{i.contains(t.target)?this.isOpened(i)?this.close(i):this.open(i):this.isOpened(i)&&this.close(i)})),t.preventDefault()}open(t){var i=this.findContent(t);this.show(t,i),this.store.save(),this.dispatch("opened",{detail:{toggler:t,content:i}})}close(t){var i=this.findContent(t);this.hide(t,i),this.store.save(),this.dispatch("closed",{detail:{toggler:t,content:i}})}show(t,i,o){void 0===o&&(o=!0),o&&(i.style.height="0px",i.removeEventListener("transitionend",this.transitionEnd),i.addEventListener("transitionend",this.transitionEnd),setTimeout((()=>{i.style.height=i.scrollHeight+"px"}))),this.toggleClass(t,i,!0),this.toggleText(t,!0)}hide(t,i,o){void 0===o&&(o=!0),o&&(i.style.height=i.scrollHeight+"px",i.removeEventListener("transitionend",this.transitionEnd),i.addEventListener("transitionend",this.transitionEnd),setTimeout((()=>{i.style.height="0px"}))),this.toggleClass(t,i,!1),this.toggleText(t,!1)}transitionEnd(t){t.target.style.height=""}toggleClass(t,i,o){o?(t.classList.add("st-accordion__icon--opened"),i.classList.add("st-accordion__content--visible")):(t.classList.remove("st-accordion__icon--opened"),i.classList.remove("st-accordion__content--visible"))}toggleText(t,i){var o;(o=t.getAttribute(i?"data-accordion-opened-text-param":"data-accordion-closed-text-param"))&&(t.innerHTML=o)}isOpened(t){return t.matches(".st-accordion__icon--opened")}findContent(t){var i=this.getID(t);return this.scope.findElement('[data-accordion-id="'+i+'"]')}getID(t){return t.getAttribute("href").replace(/^#/,"")}}s.values={storeKey:String};export{s as default};

